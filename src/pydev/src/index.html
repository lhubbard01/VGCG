<!Doctype html>

<html>
<head>
  <title>App 1</title>
  <link rel="stylesheet" href="./style.css">
<script type="text/javascript" src="./drawing.js"></script>

<script>

var drawable = drawClick;
  function handleDrawClick(e){
    ctx.moveTo(0,0);
    ctx.lineTo(canvas.width, canvas.height, 0, 1);  
    ctx.stroke();
  }
  function MousePosDebugger(e){
    var loc = document.getElementById("writeTo");
    loc.innerHTML = "<p>screenX: " + e.screenX  + "  screenY: " + e.screenY  + "</p>"
    + "<p>\nclientX: " + e.clientX + "  clientY: " + e.clientY+"</p>"
    +"<p>offsetX: " + e.offsetX + " offsetY: " + e.offsetY + "</p>"
    +"<p>Movement X: "+e.movementX+ " movementY: "+e.movementY+"</p>"
    +"<p>layerX: "+e.layerX+" layerY: " + e.layerY + "</p>";
  }
  




  

  function alerter(e){
    console.log(e);
    if (e.ctrlKey == true){
      console.log(e);
      alert("auxclick was called");
      console.log("done");
    }
  };
function preventer (e){
  e.preventDefault();
}

  
</script>
</head>
<body onauxclick="alerter(event)" oncontextmenu="preventer(event)">
<main >
<svg id="drawable_svg" onclick="drawable(event)" onmousemove="MousePosDebugger(event)" onauxclick="alerter(event)">
</svg>
<div class="UI">
  <section id="sidebar" onmousemove="MousePosDebugger(event)">
  <div class="module" id="verbose" onclick="selection(this);">verbose</div>
  <div class="module" id="build" onclick="selection(this);">build</div>
  <div class="module" id="register" onclick="selection(this);">register</div>
  </br>

  <div class="module" id="connect" onclick="selection(this);">connect</div>
  <div class="module" id="select" onclick="selection(this);">select</div>
  </br>

  <div class="module" id="input" onclick="selection(this);">input</div>
  <div class="module" id="output" onclick="selection(this);">output</div>
  
  </br>
  <div class="module" id="linear" onclick="selection(this);">linear</div>
  <div class="module" id="bilinear" onclick ="selection(this);">bilinear</div>
  
  </br>
  <div class="module" id="relu" onclick="selection(this);">relu</div>
  <div class="module" id="rect" onclick="selection(this);">rectangle</div>

  <!--<div id="drawable" style="height: 600px; width: 600px; border: 3px solid black; " onclick="drawable(event);">-->
  <!--<div id="drawCont" style=" height: 480px; background: blue" >
  <canvas style="width: 100%; height: 100%" id="drawable" onmousemove="MousePosDebugger(event)">Drawable</canvas>
  </div> -->
  <div id="right-sb" style="background: white;" onmousemove="MousePosDebugger(event)">
    <form id="formupdate" action="/api/update"  method="POST" target="_blank">
      <input id="msg-input" /> 
      <button id="sendbtn" onclick="update_send(event)">Send</button>
    </form>
  <textarea id="outcome" readonly rows="10" cols="70"></textarea>

  </section>
  </div> 
<!--
    <form id="formmodel" action="/api/model"  method="POST" target="_blank" >
      <label for="hyper-param">Hypers:</label><input id="model-input" name="hyperp" /> <br>
      <label    for="inbounds">in features:</label><input id="in-features" name="infeatures" /> <br>
      <label   for="outbounds">out features:</label><input id="out-features" name="outfeatures" /> <br>
      <label        for="Name">Name</label><input id="Name" name="Name"/><br>
      <label      for="m-type">mType</label><input id="mtype" name="mType"/><br>
      <label   for="is-native">isNative</label><input id="isnative" name="isNative" type="checkbox"/><br>
    <label for="is-parametric">isParametric</label><input id="isparametric" name="isParametric" type="checkbox"/><br>
    
    <button id="send" onclick="handleSendLayer(event)">Send 2</button>
  </form>-->
  





</main>
</body>

<p id="writeTo"></p>
<footer>Footer</footer>

<script> 
  let history = [];
  //var canvas = document.getElementById("drawable");
  
   //var SVG = document.getElementById("drawablesvg");console.log(`${SVG}`);
  //var ctx = canvas.getContext("2d");


  //console.log(canvas);
  //console.log(ctx);

  let msg_input = document.getElementById("msg-input");
  let model_input = document.getElementById("model-input");
  let form_update = document.getElementById("formupdate");
  let form_model = document.getElementById("formmodel");
  var outcome_box = document.getElementById("outcome");
  var draw = document.getElementById("drawable");
  
  async function handlePyMessageWrite(e)
  {
    let value_bfr = outcome_box.value;
    console.log(e);

    const data = JSON.stringify({data: e, route: "pyexec"});
    console.log(data);

    const options = {
              method : "POST",
              headers:  {"Content-Type":"application/json"},
              body: data
    };


    const res = await fetch("/api/update", options)
      .then(res => res.json())
      .catch(err => console.error(err));

    outcome_box.value = res.msg + "\n" + value_bfr;

    h = document.body
    b = document.getElementById("content");
    
    new_p = document.createElement("p")
    new_p.appendChild(document.createTextNode(res.msg));
    
    b.appendChild(new_p)
  }

  function update_send(e) {
    e.preventDefault();

    let text_data = msg_input.value;
    handlePyMessageWrite(text_data);

    msg_input.value = "";
  }


  form_update.addEventListener("submit", update_send);
  //draw.on_click = handleDrawClick
    
  
  
/*
  async function handleSendLayer(e)
  {
      let model_input = document.getElementById("model-input");
      let value_bufr  = outcome_box.value;

      alert (JSON.stringify(e));

      const data = JSON.stringify({data:e, route: "model"});
      
      if (e.isTrusted)
        return 1;

      const options = {
        method : "POST",
        headers: {"Content-Type":"application/json"},
        body:data

      };


      const res = await fetch("/api/model", options)
                        .then(res => res.json())
                        .catch(err =>console.error(err));

      outcome_box.value = res.msg + "\n" + value_bfr;

  }


  form_model.addEventListener("submit", 
  e => {
    e.preventDefault();
    
    let text_data = {
      hyperp: JSON.stringify(JSON.parse("{"+model_input.value+"}")),
      isParametric: true ? isparametric.value == "on" : false, 
      isNative:     true ? isnative.value == "on": false ,
      mType:        mtype.value,
      Name:         Name.value
    };


    model_input.value = "";
    handleSendLayer(text_data);
  });*/
/*
   showbtn.addEventListener("click", e => {
      e.preventDefault();
      handleUpdate("show()");
    });*/
  //drawable.addEventListener("click", genRect);
</script>
</html>
